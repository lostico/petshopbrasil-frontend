<app-page-layout
  [title]="isEditMode ? 'Editar Cliente' : 'Novo Cliente'"
  [subtitle]="isEditMode ? 'Edite os dados do cliente' : 'Cadastre um novo cliente na sua clínica'"
  [action]="{
    label: 'Voltar',
    icon: 'arrow-left',
    variant: 'secondary'
  }"
  (actionClick)="onCancel()">
  
  <div class="max-w-4xl mx-auto">


    <!-- Form -->
    <form [formGroup]="customerForm" (ngSubmit)="onSubmit()" [class.form-disabled]="loading">
      <app-card variant="elevated">
        <div class="p-6">
          <!-- Informações Pessoais -->
          <div class="mb-8">
            <h2 class="text-xl font-semibold text-secondary-900 mb-6">Informações Pessoais</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <app-input
                label="CPF *"
                type="text"
                formControlName="cpf"
                placeholder="000.000.000-00"
                [errorMessage]="getFieldError('cpf')"
                [invalid]="isFieldInvalid('cpf')"
                [valid]="isFieldValid('cpf')"
                [maxlength]="14">
              </app-input>

              <app-input
                label="Nome Completo *"
                type="text"
                formControlName="name"
                placeholder="Digite o nome completo"
                [errorMessage]="getFieldError('name')"
                [invalid]="isFieldInvalid('name')"
                [valid]="isFieldValid('name')">
              </app-input>

              <app-input
                label="Email"
                type="email"
                formControlName="email"
                placeholder="email@exemplo.com"
                [errorMessage]="getFieldError('email')"
                [invalid]="isFieldInvalid('email')"
                [valid]="isFieldValid('email')">
              </app-input>

              <app-input
                label="Telefone *"
                type="text"
                formControlName="phone"
                placeholder="(00) 00000-0000"
                [errorMessage]="getFieldError('phone')"
                [invalid]="isFieldInvalid('phone')"
                [valid]="isFieldValid('phone')"
                [maxlength]="15">
              </app-input>

              <app-input
                label="Data de Nascimento"
                type="date"
                formControlName="birthDate">
              </app-input>
            </div>
          </div>



          <!-- Endereço -->
          <div>
            <h2 class="text-xl font-semibold text-secondary-900 mb-6">Endereço</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="md:col-span-2">
                <app-input
                  label="Endereço"
                  type="text"
                  formControlName="address"
                  placeholder="Rua, número, complemento">
                </app-input>
              </div>

              <app-input
                label="Cidade"
                type="text"
                formControlName="city"
                placeholder="Digite a cidade">
              </app-input>

              <app-select
                label="Estado"
                placeholder="Selecione o estado"
                formControlName="state"
                [options]="getStateOptions()">
              </app-select>

              <app-input
                label="CEP"
                type="text"
                formControlName="zipCode"
                placeholder="00000-000"
                [errorMessage]="getFieldError('zipCode')"
                [invalid]="isFieldInvalid('zipCode')"
                [valid]="isFieldValid('zipCode')"
                [maxlength]="9">
              </app-input>
            </div>
          </div>
        </div>
      </app-card>

      <!-- Form Actions -->
      <div class="flex items-center justify-end gap-4 mt-8">
        <app-button 
          label="Cancelar"
          variant="secondary"
          (clicked)="onCancel()">
        </app-button>
        
        <app-button 
          [label]="isEditMode ? 'Atualizar Cliente' : 'Cadastrar Cliente'"
          variant="primary"
          [loading]="loading"
          [disabled]="loading || customerForm.invalid"
          type="submit">
        </app-button>
      </div>
    </form>
  </div>
</app-page-layout>
