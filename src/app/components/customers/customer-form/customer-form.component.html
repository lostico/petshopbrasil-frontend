<div class="form-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1>{{ isEditMode ? 'Editar Cliente' : 'Novo Cliente' }}</h1>
      <p>{{ isEditMode ? 'Edite os dados do cliente' : 'Cadastre um novo cliente na sua clínica' }}</p>
    </div>
    <button class="btn-secondary" (click)="onCancel()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      Voltar
    </button>
  </div>

  <!-- Success Message -->
  <div *ngIf="success" class="success-message">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
      <polyline points="22,4 12,14.01 9,11.01"/>
    </svg>
    {{ isEditMode ? 'Cliente atualizado com sucesso!' : 'Cliente cadastrado com sucesso!' }} Redirecionando...
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <line x1="15" y1="9" x2="9" y2="15"/>
      <line x1="9" y1="9" x2="15" y2="15"/>
    </svg>
    {{ error }}
  </div>

  <!-- Form -->
  <form [formGroup]="customerForm" (ngSubmit)="onSubmit()" class="customer-form" [class.form-disabled]="loading">
    <div class="form-sections">
      <!-- Informações Pessoais -->
      <div class="form-section">
        <h2>Informações Pessoais</h2>
        
        <div class="form-row">
          <div class="form-group">
            <label for="cpf">CPF *</label>
            <input 
              type="text" 
              id="cpf"
              formControlName="cpf"
              placeholder="000.000.000-00"
              [class.invalid]="isFieldInvalid('cpf')"
              [class.valid]="isFieldValid('cpf')"
              maxlength="14"
            >
            <span class="error-text" *ngIf="getFieldError('cpf')">
              {{ getFieldError('cpf') }}
            </span>
          </div>

          <div class="form-group">
            <label for="name">Nome Completo *</label>
            <input 
              type="text" 
              id="name"
              formControlName="name"
              placeholder="Digite o nome completo"
              [class.invalid]="isFieldInvalid('name')"
              [class.valid]="isFieldValid('name')"
            >
            <span class="error-text" *ngIf="getFieldError('name')">
              {{ getFieldError('name') }}
            </span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="email">Email</label>
            <input 
              type="email" 
              id="email"
              formControlName="email"
              placeholder="email@exemplo.com"
              [class.invalid]="isFieldInvalid('email')"
              [class.valid]="isFieldValid('email')"
            >
            <span class="error-text" *ngIf="getFieldError('email')">
              {{ getFieldError('email') }}
            </span>
          </div>

          <div class="form-group">
            <label for="phone">Telefone *</label>
            <input 
              type="text" 
              id="phone"
              formControlName="phone"
              placeholder="(00) 00000-0000"
              [class.invalid]="isFieldInvalid('phone')"
              [class.valid]="isFieldValid('phone')"
              maxlength="15"
            >
            <span class="error-text" *ngIf="getFieldError('phone')">
              {{ getFieldError('phone') }}
            </span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="birthDate">Data de Nascimento</label>
            <input 
              type="date" 
              id="birthDate"
              formControlName="birthDate"
            >
          </div>
        </div>
      </div>

      <!-- Endereço -->
      <div class="form-section">
        <h2>Endereço</h2>
        
        <div class="form-row">
          <div class="form-group">
            <label for="address">Endereço</label>
            <input 
              type="text" 
              id="address"
              formControlName="address"
              placeholder="Rua, número, complemento"
            >
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="city">Cidade</label>
            <input 
              type="text" 
              id="city"
              formControlName="city"
              placeholder="Digite a cidade"
            >
          </div>

          <div class="form-group">
            <label for="state">Estado</label>
            <select id="state" formControlName="state">
              <option value="">Selecione o estado</option>
              <option *ngFor="let state of getStates()" [value]="state">
                {{ state }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="zipCode">CEP</label>
            <input 
              type="text" 
              id="zipCode"
              formControlName="zipCode"
              placeholder="00000-000"
              [class.invalid]="isFieldInvalid('zipCode')"
              [class.valid]="isFieldValid('zipCode')"
              maxlength="9"
            >
            <span class="error-text" *ngIf="getFieldError('zipCode')">
              {{ getFieldError('zipCode') }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" class="btn-secondary" (click)="onCancel()">
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn-primary" 
        [disabled]="loading || customerForm.invalid"
      >
        <div *ngIf="loading" class="loading-spinner-small"></div>
        <span *ngIf="!loading">{{ isEditMode ? 'Atualizar Cliente' : 'Cadastrar Cliente' }}</span>
        <span *ngIf="loading">{{ isEditMode ? 'Atualizando...' : 'Cadastrando...' }}</span>
      </button>
    </div>
  </form>
</div>
